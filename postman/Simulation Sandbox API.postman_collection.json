{
  "info": {
    "_postman_id": "adb8979f-c4e9-4afc-a925-3abacc5373bb",
    "name": "Simulation Sandbox API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "51501795"
  },
  "item": [
    {
      "name": "Delete a Repo",
      "request": {
        "auth": {
          "type": "bearer",
          "bearer": [
            {
              "key": "token",
              "value": "{{GITHUB_TOKEN}}",
              "type": "string"
            }
          ]
        },
        "method": "DELETE",
        "header": [
          {
            "key": "Accept",
            "value": "application/json",
            "type": "text"
          }
        ],
        "url": {
          "raw": "https://api.github.com/repos/psl-copilot/rule-9093",
          "protocol": "https",
          "host": [
            "api",
            "github",
            "com"
          ],
          "path": [
            "repos",
            "psl-copilot",
            "rule-9093"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Health Check",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/api/health",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "api",
            "health"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Bootstrap Rule Repository",
      "request": {
        "auth": {
          "type": "bearer",
          "bearer": [
            {
              "key": "token",
              "value": "{{ACCESS_TOKEN}}",
              "type": "string"
            }
          ]
        },
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"ruleId\": \"148\",\n  \"ruleVersion\": \"1.0.0\", \n  \"organization\": \"psl-copilot\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/v1/bootstrap",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "api",
            "v1",
            "bootstrap"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Populate Rule Repository",
      "request": {
        "auth": {
          "type": "bearer",
          "bearer": [
            {
              "key": "token",
              "value": "{{ACCESS_TOKEN}}",
              "type": "string"
            }
          ]
        },
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"organization\": \"psl-copilot\",\n  \"ruleId\": \"148\",\n  \"ruleCode\": \"Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjAKCmltcG9ydCB0eXBlIHsgRGF0YWJhc2VNYW5hZ2VySW5zdGFuY2UsIExvZ2dlclNlcnZpY2UsIE1hbmFnZXJDb25maWcgfSBmcm9tICdAdGF6YW1hLWxmL2ZybXMtY29lLWxpYic7CmltcG9ydCB0eXBlIHsgT3V0Y29tZVJlc3VsdCwgUnVsZUNvbmZpZywgUnVsZVJlcXVlc3QsIFJ1bGVSZXN1bHQgfSBmcm9tICdAdGF6YW1hLWxmL2ZybXMtY29lLWxpYi9saWIvaW50ZXJmYWNlcyc7CgpleHBvcnQgdHlwZSBSdWxlRXhlY3V0b3JDb25maWcgPSBSZXF1aXJlZDxQaWNrPE1hbmFnZXJDb25maWcsICdyYXdIaXN0b3J5JyB8ICdldmVudEhpc3RvcnknIHwgJ2NvbmZpZ3VyYXRpb24nIHwgJ2xvY2FsQ2FjaGVDb25maWcnPj47CgppbnRlcmZhY2UgUXVlcnlSZXN1bHQgewogIHRhcmdldEFtb3VudDogbnVtYmVyIHwgc3RyaW5nOwogIGhpc3RvcmljYWxBbW91bnRzOiBBcnJheTxzdHJpbmcgfCBudW1iZXI+Owp9CgpleHBvcnQgY29uc3QgYW1vdW50VHJhY2tpbmcgPSAodG9sZXJhbmNlOiBudW1iZXIsIHRhcmdldEFtb3VudDogbnVtYmVyLCBoaXN0b3JpY2FsQW1vdW50czogbnVtYmVyW10pOiBudW1iZXIgPT4gewogIGxldCBhbW91bnRUcmFja2VyID0gMDsKICBjb25zdCBvZmZzZXRUb2xlcmFuY2UgPSB0YXJnZXRBbW91bnQgKiB0b2xlcmFuY2U7CgogIGZvciAobGV0IGkgPSAwOyBpIDwgaGlzdG9yaWNhbEFtb3VudHMubGVuZ3RoOyBpICs9IDEpIHsKICAgIGNvbnN0IGFtb3VudCA9IGhpc3RvcmljYWxBbW91bnRzW2ldOwogICAgYW1vdW50VHJhY2tlciArPSBhbW91bnQ7CgogICAgaWYgKGFtb3VudFRyYWNrZXIgPiB0YXJnZXRBbW91bnQgLSBvZmZzZXRUb2xlcmFuY2UgJiYgYW1vdW50VHJhY2tlciA8IHRhcmdldEFtb3VudCArIG9mZnNldFRvbGVyYW5jZSkgewogICAgICByZXR1cm4gaSArIDE7CiAgICB9CiAgfQoKICByZXR1cm4gLTE7Cn07CgpleHBvcnQgY29uc3QgaGFuZGxlVHJhbnNhY3Rpb24gPSBhc3luYyAoCiAgcmVxOiBSdWxlUmVxdWVzdCwKICBkZXRlcm1pbmVPdXRjb21lOiAodmFsdWU6IG51bWJlciwgcnVsZUNvbmZpZzogUnVsZUNvbmZpZywgcnVsZVJlc3VsdDogUnVsZVJlc3VsdCkgPT4gUnVsZVJlc3VsdCwKICBydWxlUmVzdWx0OiBSdWxlUmVzdWx0LAogIF9sb2dnZXJTZXJ2aWNlOiBMb2dnZXJTZXJ2aWNlLAogIHJ1bGVDb25maWc6IFJ1bGVDb25maWcsCiAgZGF0YWJhc2VNYW5hZ2VyOiBEYXRhYmFzZU1hbmFnZXJJbnN0YW5jZTxSdWxlRXhlY3V0b3JDb25maWc+LAopOiBQcm9taXNlPFJ1bGVSZXN1bHQ+ID0+IHsKICBpZiAoIXJ1bGVDb25maWcuY29uZmlnLmJhbmRzPy5sZW5ndGgpIHsKICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjb25maWcgcHJvdmlkZWQgLSBiYW5kcyBub3QgcHJvdmlkZWQnKTsKICB9CgogIGlmICghcnVsZUNvbmZpZy5jb25maWcucGFyYW1ldGVycykgewogICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGNvbmZpZyBwcm92aWRlZCAtIHBhcmFtZXRlcnMgbm90IHByb3ZpZGVkJyk7CiAgfQoKICBpZiAoIXJ1bGVDb25maWcuY29uZmlnLnBhcmFtZXRlcnMudG9sZXJhbmNlIHx8IHR5cGVvZiBydWxlQ29uZmlnLmNvbmZpZy5wYXJhbWV0ZXJzLnRvbGVyYW5jZSAhPT0gJ251bWJlcicpIHsKICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjb25maWcgcHJvdmlkZWQgLSB0b2xlcmFuY2UgcGFyYW1ldGVyIG5vdCBwcm92aWRlZCBvciBpbnZhbGlkIHR5cGUnKTsKICB9CgogIGlmICghcnVsZUNvbmZpZy5jb25maWcucGFyYW1ldGVycy5tYXhRdWVyeVJhbmdlIHx8IHR5cGVvZiBydWxlQ29uZmlnLmNvbmZpZy5wYXJhbWV0ZXJzLm1heFF1ZXJ5UmFuZ2UgIT09ICdudW1iZXInKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgY29uZmlnIHByb3ZpZGVkIC0gbWF4UXVlcnlSYW5nZSBwYXJhbWV0ZXIgbm90IHByb3ZpZGVkIG9yIGludmFsaWQgdHlwZScpOwogIH0KCiAgaWYgKCFydWxlQ29uZmlnLmNvbmZpZy5leGl0Q29uZGl0aW9ucz8ubGVuZ3RoKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgY29uZmlnIHByb3ZpZGVkIC0gZXhpdENvbmRpdGlvbnMgbm90IHByb3ZpZGVkJyk7CiAgfQoKICBpZiAocmVxLnRyYW5zYWN0aW9uLkZJVG9GSVBtdFN0cy5UeEluZkFuZFN0cy5UeFN0cyAhPT0gJ0FDQ0MnKSB7CiAgICBjb25zdCBVbnN1Y2Nlc3NmdWxUcmFuc2FjdGlvbiA9IHJ1bGVDb25maWcuY29uZmlnLmV4aXRDb25kaXRpb25zLmZpbmQoKGI6IE91dGNvbWVSZXN1bHQpID0+IGIuc3ViUnVsZVJlZiA9PT0gJy54MDAnKTsKICAgIGlmIChVbnN1Y2Nlc3NmdWxUcmFuc2FjdGlvbiA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignVW5zdWNjZXNzZnVsIHRyYW5zYWN0aW9uIGFuZCBubyBleGl0IGNvbmRpdGlvbiBpbiBjb25maWcnKTsKICAgIH0KICAgIHJldHVybiB7CiAgICAgIC4uLnJ1bGVSZXN1bHQsCiAgICAgIHJlYXNvbjogVW5zdWNjZXNzZnVsVHJhbnNhY3Rpb24ucmVhc29uLAogICAgICBzdWJSdWxlUmVmOiBVbnN1Y2Nlc3NmdWxUcmFuc2FjdGlvbi5zdWJSdWxlUmVmLAogICAgfTsKICB9CgogIGlmICghcmVxLkRhdGFDYWNoZS5jZHRyQWNjdElkKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoJ0RhdGFDYWNoZSBvYmplY3Qgbm90IHJldHJpZXZhYmxlJyk7CiAgfQoKICBpZiAoIXJlcS5EYXRhQ2FjaGUuY3JlRHRUbSkgewogICAgdGhyb3cgbmV3IEVycm9yKCdEYXRhQ2FjaGUgZG9lcyBub3QgaGF2ZSBDcmVEdFRtJyk7CiAgfQoKICBjb25zdCBjdXJyZW50UGFjczAwMlRpbWVGcmFtZSA9IHJlcS50cmFuc2FjdGlvbi5GSVRvRklQbXRTdHMuR3JwSGRyLkNyZUR0VG07CiAgY29uc3QgY3JlZGl0b3JBY2NvdW50SWQgPSByZXEuRGF0YUNhY2hlLmNkdHJBY2N0SWQ7CiAgY29uc3QgdGVuYW50SWQgPSByZXEudHJhbnNhY3Rpb24uVGVuYW50SWQ7CgogIGNvbnN0IHF1ZXJ5U3RyaW5nID0gYAogICAgV0lUSCBuZXdlc3QgQVMgKAogICAgICBTRUxFQ1QKICAgICAgICBFbmRUb0VuZElkLAogICAgICAgIEFtdCwKICAgICAgICBDcmVEdFRtOjp0aW1lc3RhbXB0egogICAgICBGUk9NCiAgICAgICAgdHJhbnNhY3Rpb24KICAgICAgV0hFUkUKICAgICAgICBzb3VyY2UgPSAkMQogICAgICAgIEFORCBUeFRwID0gJ3BhY3MuMDA4LjAwMS4xMCcKICAgICAgICBBTkQgQ3JlRHRUbTo6dGltZXN0YW1wdHogPCAkMjo6dGltZXN0YW1wdHoKICAgICAgICBBTkQgVGVuYW50SWQgPSAkNQogICAgICBPUkRFUiBCWQogICAgICAgIENyZUR0VG06OnRpbWVzdGFtcHR6IERFU0MKICAgICAgTElNSVQKICAgICAgICAxCiAgICApLCBhbGxfc3VjY2VzcyBBUyAoCiAgICAgIFNFTEVDVAogICAgICAgIERJU1RJTkNUIHQuRW5kVG9FbmRJZAogICAgICBGUk9NCiAgICAgICAgdHJhbnNhY3Rpb24gdAogICAgICAgIEpPSU4gbmV3ZXN0IG4gT04gVFJVRQogICAgICBXSEVSRQogICAgICAgIHQuc291cmNlID0gJDEKICAgICAgICBBTkQgdC5UeFRwID0gJ3BhY3MuMDAyLjAwMS4xMicKICAgICAgICBBTkQgdC5UeFN0cyA9ICdBQ0NDJwogICAgICAgIEFORCB0LkNyZUR0VG06OnRpbWVzdGFtcHR6IDwgbi5DcmVEdFRtOjp0aW1lc3RhbXB0egogICAgICAgIEFORCB0LkNyZUR0VG06OnRpbWVzdGFtcHR6ID49IG4uQ3JlRHRUbTo6dGltZXN0YW1wdHogLSAoJDM6OmJpZ2ludCAqIGludGVydmFsICcxIG1pbGxpc2Vjb25kJykKICAgICAgICBBTkQgdC5DcmVEdFRtOjp0aW1lc3RhbXB0eiA8PSAkNDo6dGltZXN0YW1wdHoKICAgICAgICBBTkQgdC5UZW5hbnRJZCA9ICQ1CiAgICApLAogICAgaGlzdCBBUyAoCiAgICAgIFNFTEVDVAogICAgICAgIHQuQW10IEFTIGFtdCwKICAgICAgICB0LkNyZUR0VG06OnRpbWVzdGFtcHR6CiAgICAgIEZST00KICAgICAgICB0cmFuc2FjdGlvbiB0CiAgICAgICAgSk9JTiBhbGxfc3VjY2VzcyBzIFVTSU5HIChFbmRUb0VuZElkKQogICAgICBXSEVSRQogICAgICAgIHQuVHhUcCA9ICdwYWNzLjAwOC4wMDEuMTAnCiAgICAgICAgQU5EIHQuVGVuYW50SWQgPSAkNQogICAgICBPUkRFUiBCWQogICAgICAgIHQuQ3JlRHRUbTo6dGltZXN0YW1wdHogREVTQwogICAgKQogICAgU0VMRUNUCiAgICAgICgKICAgICAgICBTRUxFQ1QKICAgICAgICAgIG4uQW10CiAgICAgICAgRlJPTQogICAgICAgICAgbmV3ZXN0IG4KICAgICAgKSBBUyAidGFyZ2V0QW1vdW50IiwKICAgICAgQ09BTEVTQ0UoCiAgICAgICAgKAogICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgIGFycmF5X2FnZygKICAgICAgICAgICAgICBhbXQKICAgICAgICAgICAgICBPUkRFUiBCWQogICAgICAgICAgICAgICAgQ3JlRHRUbTo6dGltZXN0YW1wdHogREVTQwogICAgICAgICAgICApCiAgICAgICAgICBGUk9NCiAgICAgICAgICAgIGhpc3QKICAgICAgICApLAogICAgICAgICd7fSc6Om51bWVyaWMgW10KICAgICAgKSBBUyAiaGlzdG9yaWNhbEFtb3VudHMiO2A7CgogIGNvbnN0IHF1ZXJ5UmVzdWx0ID0gYXdhaXQgZGF0YWJhc2VNYW5hZ2VyLl9ldmVudEhpc3RvcnkucXVlcnk8UXVlcnlSZXN1bHQ+KHF1ZXJ5U3RyaW5nLCBbCiAgICBjcmVkaXRvckFjY291bnRJZCwKICAgIHJlcS5EYXRhQ2FjaGUuY3JlRHRUbSwKICAgIHJ1bGVDb25maWcuY29uZmlnLnBhcmFtZXRlcnMubWF4UXVlcnlSYW5nZSwKICAgIGN1cnJlbnRQYWNzMDAyVGltZUZyYW1lLAogICAgdGVuYW50SWQsCiAgXSk7CgogIGNvbnN0IHVuV3JhcHBlZFJlc3VsdDogeyB0YXJnZXRBbW91bnQ6IG51bWJlcjsgaGlzdG9yaWNhbEFtb3VudHM6IG51bWJlcltdIH0gPSB7CiAgICB0YXJnZXRBbW91bnQ6IE51bWJlcihxdWVyeVJlc3VsdC5yb3dzWzBdPy50YXJnZXRBbW91bnQpLAogICAgaGlzdG9yaWNhbEFtb3VudHM6IHF1ZXJ5UmVzdWx0LnJvd3MubWFwKChyb3cpID0+IHJvdy5oaXN0b3JpY2FsQW1vdW50cy5mbGF0KCkubWFwKCh2KSA9PiBOdW1iZXIodikpKS5mbGF0KCksCiAgfTsKCiAgaWYgKCF1bldyYXBwZWRSZXN1bHQ/Lmhpc3RvcmljYWxBbW91bnRzLmxlbmd0aCkgewogICAgY29uc3QgcmVhc29uID0KICAgICAgcnVsZUNvbmZpZy5jb25maWcuZXhpdENvbmRpdGlvbnMuZmluZCgoZXhpdCkgPT4gZXhpdC5zdWJSdWxlUmVmID09PSAnLngwMScpPy5yZWFzb24gPz8KICAgICAgJ0luc3VmZmljaWVudCB0cmFuc2FjdGlvbiBoaXN0b3J5IGFuZCBubyBleGl0IGNvbmRpdGlvbiBpbiBjb25maWcnOwogICAgcmV0dXJuIHsgLi4ucnVsZVJlc3VsdCwgc3ViUnVsZVJlZjogJy54MDEnLCByZWFzb24gfTsKICB9CgogIGlmICghdW5XcmFwcGVkUmVzdWx0LnRhcmdldEFtb3VudCkgewogICAgdGhyb3cgbmV3IEVycm9yKCdEYXRhIGVycm9yOiBpcnJldHJpZXZhYmxlIHRyYW5zYWN0aW9uIGhpc3RvcnknKTsKICB9CgogIGNvbnN0IGFsbE51bWJlcnMgPSB1bldyYXBwZWRSZXN1bHQuaGlzdG9yaWNhbEFtb3VudHMuZXZlcnkoKGVsZW1lbnQpID0+ICFpc05hTihlbGVtZW50KSk7CgogIGlmICghYWxsTnVtYmVycykgewogICAgdGhyb3cgbmV3IEVycm9yKCdEYXRhIGVycm9yOiBxdWVyeSByZXN1bHQgdHlwZSBtaXNtYXRjaCAtIGV4cGVjdGVkIFtudW1iZXJzXScpOwogIH0KCiAgY29uc3QgeyB0b2xlcmFuY2UgfSA9IHJ1bGVDb25maWcuY29uZmlnLnBhcmFtZXRlcnM7CiAgY29uc3QgeyB0YXJnZXRBbW91bnQsIGhpc3RvcmljYWxBbW91bnRzIH0gPSB1bldyYXBwZWRSZXN1bHQ7CgogIGNvbnN0IGl0ZXJhdGlvblZhbHVlID0gYW1vdW50VHJhY2tpbmcodG9sZXJhbmNlLCB0YXJnZXRBbW91bnQsIGhpc3RvcmljYWxBbW91bnRzKTsKCiAgaWYgKGl0ZXJhdGlvblZhbHVlID09PSAtMSkgewogICAgY29uc3QgcmVhc29uID0KICAgICAgcnVsZUNvbmZpZy5jb25maWcuZXhpdENvbmRpdGlvbnMuZmluZCgoZXhpdCkgPT4gZXhpdC5zdWJSdWxlUmVmID09PSAnLngwMycpPy5yZWFzb24gPz8KICAgICAgJ05vIG5vbi1jb21taXNzaW9uZWQgdHJhbnNhY3Rpb24gbWlycm9yaW5nIGRldGVjdGVkIGFuZCBubyBleGl0IGNvbmRpdGlvbiBpbiBjb25maWcnOwogICAgcmV0dXJuIHsgLi4ucnVsZVJlc3VsdCwgc3ViUnVsZVJlZjogJy54MDMnLCByZWFzb24gfTsKICB9CgogIHJldHVybiBkZXRlcm1pbmVPdXRjb21lKGl0ZXJhdGlvblZhbHVlLCBydWxlQ29uZmlnLCBydWxlUmVzdWx0KTsKfTs=\",\n  \"testCode\": \"Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjAKCmltcG9ydCB7IERhdGFDYWNoZSwgUGFjczAwMiwgUnVsZUNvbmZpZywgUnVsZVJlcXVlc3QsIFJ1bGVSZXN1bHQgfSBmcm9tICdAdGF6YW1hLWxmL2ZybXMtY29lLWxpYi9saWIvaW50ZXJmYWNlcyc7CmltcG9ydCB7CiAgRGF0YWJhc2VNYW5hZ2VyTW9jaywKICBkZXRlcm1pbmVPdXRjb21lLAogIExvZ2dlclNlcnZpY2VNb2NrLAogIE1vY2tEYXRhYmFzZU1hbmFnZXJGYWN0b3J5LAogIE1vY2tMb2dnZXJTZXJ2aWNlRmFjdG9yeSwKfSBmcm9tICdAdGF6YW1hLWxmL2ZybXMtY29lLWxpYi9saWIvdGVzdHMvbW9ja3MnOwppbXBvcnQgeyBhbW91bnRUcmFja2luZywgaGFuZGxlVHJhbnNhY3Rpb24sIFJ1bGVFeGVjdXRvckNvbmZpZyB9IGZyb20gJy4uLy4uL3NyYy9ydWxlJzsKCmNvbnN0IHJ1bGVDb25maWc6IFJ1bGVDb25maWcgPSB7CiAgaWQ6ICcwMjRAMS4wLjAnLAogIGNmZzogJzEuMC4wJywKICB0ZW5hbnRJZDogJ0RFRkFVTFQnLAogIGRlc2M6ICdOb24tY29tbWlzc2lvbmVkIHRyYW5zYWN0aW9uIG1pcnJvcmluZycsCiAgY29uZmlnOiB7CiAgICBwYXJhbWV0ZXJzOiB7CiAgICAgIG1heFF1ZXJ5UmFuZ2U6IDg2NDAwMDAwLAogICAgICB0b2xlcmFuY2U6IDAuMSwKICAgIH0sCiAgICBleGl0Q29uZGl0aW9uczogWwogICAgICB7CiAgICAgICAgc3ViUnVsZVJlZjogJy54MDAnLAogICAgICAgIHJlYXNvbjogJ1Vuc3VjY2Vzc2Z1bCB0cmFuc2FjdGlvbicsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBzdWJSdWxlUmVmOiAnLngwMScsCiAgICAgICAgcmVhc29uOiAnSW5zdWZmaWNpZW50IHRyYW5zYWN0aW9uIGhpc3RvcnknLAogICAgICB9LAogICAgICB7CiAgICAgICAgc3ViUnVsZVJlZjogJy54MDMnLAogICAgICAgIHJlYXNvbjogJ05vIG5vbi1jb21taXNzaW9uZWQgdHJhbnNhY3Rpb24gbWlycm9yaW5nIGRldGVjdGVkJywKICAgICAgfSwKICAgIF0sCiAgICBiYW5kczogWwogICAgICB7CiAgICAgICAgc3ViUnVsZVJlZjogJy4wMScsCiAgICAgICAgdXBwZXJMaW1pdDogMiwKICAgICAgICByZWFzb246ICdJbW1lZGlhdGUgbm9uLWNvbW1pc3Npb25lZCB0cmFuc2FjdGlvbiBtaXJyb3JpbmcgZGV0ZWN0ZWQnLAogICAgICB9LAogICAgICB7CiAgICAgICAgc3ViUnVsZVJlZjogJy4wMicsCiAgICAgICAgbG93ZXJMaW1pdDogMiwKICAgICAgICByZWFzb246ICdBZ2dyZWdhdGVkIG5vbi1jb21taXNzaW9uZWQgdHJhbnNhY3Rpb24gbWlycm9yaW5nIGRldGVjdGVkJywKICAgICAgfSwKICAgIF0sCiAgfSwKfTsKCmNvbnN0IGdldE1vY2tSZXF1ZXN0ID0gKCkgPT4gewogIGNvbnN0IHF1b3RlID0gewogICAgdHJhbnNhY3Rpb246IEpTT04ucGFyc2UoCiAgICAgIGB7IlR4VHAiOiJwYWNzLjAwMi4wMDEuMTIiLCJGSVRvRklQbXRTdHMiOnsiR3JwSGRyIjp7Ik1zZ0lkIjoiMzBiZWE3MWM1YTA1NDk3OGFkMGRhN2Y5NGIyYTQwZTk3ODkiLCJDcmVEdFRtIjoiJHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCl9In0sIlR4SW5mQW5kU3RzIjp7Ik9yZ25sSW5zdHJJZCI6IjVhYjRmYzczNTVkZTRlZjhhNzViNzhiMDBhNjgxZWQyMjU1IiwiT3JnbmxFbmRUb0VuZElkIjoiMmM1MTY4MDEwMDc2NDJkZmI4OTI5NDRkZGUxY2Y4NDU4OTciLCJUeFN0cyI6IkFDQ0MiLCJDaHJnc0luZiI6W3siQW10Ijp7IkFtdCI6MzA3LjE0LCJDY3kiOiJVU0QifSwiQWd0Ijp7IkZpbkluc3RuSWQiOnsiQ2xyU3lzTW1iSWQiOnsiTW1iSWQiOiJkZnNwMDAxIn19fX0seyJBbXQiOnsiQW10IjoxNTMuNTcsIkNjeSI6IlVTRCJ9LCJBZ3QiOnsiRmluSW5zdG5JZCI6eyJDbHJTeXNNbWJJZCI6eyJNbWJJZCI6ImRmc3AwMDEifX19fSx7IkFtdCI6eyJBbXQiOjMwLjcxLCJDY3kiOiJVU0QifSwiQWd0Ijp7IkZpbkluc3RuSWQiOnsiQ2xyU3lzTW1iSWQiOnsiTW1iSWQiOiJkZnNwMDAyIn19fX1dLCJBY2NwdG5jRHRUbSI6IjIwMjEtMTItMDNUMTU6MjQ6MjYuMDAwWiIsIkluc3RnQWd0Ijp7IkZpbkluc3RuSWQiOnsiQ2xyU3lzTW1iSWQiOnsiTW1iSWQiOiJkZnNwMDAxIn19fSwiSW5zdGRBZ3QiOnsiRmluSW5zdG5JZCI6eyJDbHJTeXNNbWJJZCI6eyJNbWJJZCI6ImRmc3AwMDIifX19fX19YCwKICAgICksCgogICAgbmV0d29ya01hcDogSlNPTi5wYXJzZSgKICAgICAgJ3sibWVzc2FnZXMiOlt7ImlkIjoiMDA4QDEuMC4wIiwiaG9zdCI6Imh0dHBzOi8vZ2F0ZXdheS5vcGVuZmFhczo4MDgwL2Z1bmN0aW9uL29mZi10cmFuc2FjdGlvbi1hZ2dyZWdhdGlvbi1kZWNpc2lvbmluZy1wcm9jZXNzb3ItcmVsLTEtMS0wIiwiY2ZnIjoiMS4wLjAiLCJ0eFRwIjoicGFjcy4wMDIuMDAxLjEyIiwiY2hhbm5lbHMiOlt7ImlkIjoiMDA4QDEuMC4wIiwiaG9zdCI6Imh0dHBzOi8vZ2F0ZXdheS5vcGVuZmFhczo4MDgwL2Z1bmN0aW9uL29mZi1jaGFubmVsLWFnZ3JlZ2F0aW9uLWRlY2lzaW9uaW5nLXByb2Nlc3Nvci1yZWwtMS0xLTAiLCJjZmciOiIxLjAuMCIsInR5cG9sb2dpZXMiOlt7ImlkIjoiMDI4QDEuMC4wIiwiaG9zdCI6Imh0dHBzOi8vZ2F0ZXdheS5vcGVuZmFhczo4MDgwL2Z1bmN0aW9uL29mZi10eXBvbG9neS1wcm9jZXNzb3ItcmVsLTEtMC0wIiwiY2ZnIjoiMS4wLjAiLCJydWxlcyI6W3siaWQiOiIwMDhAMS4wLjAiLCJob3N0IjoiaHR0cHM6Ly9nYXRld2F5Lm9wZW5mYWFzOjgwODAvZnVuY3Rpb24vb2ZmLXJ1bGUtMDA4LXJlbC0xLTAtMCIsImNmZyI6IjEuMC4wIn1dfV19XX1dfScsCiAgICApLAogICAgRGF0YUNhY2hlOiBKU09OLnBhcnNlKAogICAgICBgeyJkYnRySWQiOiAiZGJ0cl81MTZjNzA2NWQ3NWI0ZmNlYTZmZmZiNTJhOTUzOTM1NyIsImNkdHJJZCI6ICJjZHRyX2IwODZhMWUxOTM3OTQxOTJiMzJjOGFmODU1MGQ3MjFkIiwiZGJ0ckFjY3RJZCI6ICJkYnRyQWNjdF85MDVjYzQyZjU3OGI0NjAwYWIyMmVmZmJhYjcyZjBiYyIsImNkdHJBY2N0SWQiOiAiY2R0ckFjY3RfZDUzMWUxYmE0ZWQ4NGEyNDhmZTI2NjE3ZTc5ZmNiNjQiLCAiYW10IjogeyJhbXQiOjEwMCwgImNjeSI6ICJaQVIifSwgImNyZUR0VG0iOiAke0RhdGUubm93KCkudG9TdHJpbmcoKX19YCwKICAgICksCiAgfTsKICByZXR1cm4gcXVvdGUgYXMgUnVsZVJlcXVlc3Q7Cn07CgpsZXQgcnVsZVJlc3VsdDogUnVsZVJlc3VsdDsKCmxldCBkYXRhYmFzZU1hbmFnZXI6IERhdGFiYXNlTWFuYWdlck1vY2s8UnVsZUV4ZWN1dG9yQ29uZmlnPjsKbGV0IGxvZ2dlclNlcnZpY2U6IExvZ2dlclNlcnZpY2VNb2NrOwoKZGVzY3JpYmUoJ1J1bGUgMDI0IFRlc3QnLCAoKSA9PiB7CiAgYmVmb3JlRWFjaCgoKSA9PiB7CiAgICBsb2dnZXJTZXJ2aWNlID0gTW9ja0xvZ2dlclNlcnZpY2VGYWN0b3J5KCk7CiAgICBsb2dnZXJTZXJ2aWNlLnJlc2V0TW9jaygpOwogICAgZGF0YWJhc2VNYW5hZ2VyID0gTW9ja0RhdGFiYXNlTWFuYWdlckZhY3Rvcnk8UnVsZUV4ZWN1dG9yQ29uZmlnPigpOwogICAgZGF0YWJhc2VNYW5hZ2VyLnJlc2V0TW9jaygpOwogICAgcnVsZVJlc3VsdCA9IHsKICAgICAgaWQ6IGAwMjRAMS4wLjBgLAogICAgICBjZmc6ICcxLjAuMCcsCiAgICAgIHRlbmFudElkOiAnREVGQVVMVCcsCiAgICAgIHN1YlJ1bGVSZWY6ICcuMDAnLAogICAgICByZWFzb246ICcnLAogICAgfTsKICB9KTsKICBkZXNjcmliZSgnUnVsZS0wMjQgYmFuZHMgVGVzdGluZycsICgpID0+IHsKICAgIHRlc3QoYC4wMSBzaG91bGQgcmV0dXJuIHJlYXNvbiBvZiAnSW1tZWRpYXRlIG5vbi1jb21taXNzaW9uZWQgdHJhbnNhY3Rpb24gbWlycm9yaW5nIGRldGVjdGVkJ2AsIGFzeW5jICgpID0+IHsKICAgICAgZGF0YWJhc2VNYW5hZ2VyLl9ldmVudEhpc3RvcnkucXVlcnkubW9ja1Jlc29sdmVkVmFsdWUoeyByb3dzOiBbeyB0YXJnZXRBbW91bnQ6IDEwMDAsIGhpc3RvcmljYWxBbW91bnRzOiBbMTAwMl0gfV0gfSk7CgogICAgICBjb25zdCByZXMgPSBhd2FpdCBoYW5kbGVUcmFuc2FjdGlvbihnZXRNb2NrUmVxdWVzdCgpLCBkZXRlcm1pbmVPdXRjb21lLCBydWxlUmVzdWx0LCBsb2dnZXJTZXJ2aWNlLCBydWxlQ29uZmlnLCBkYXRhYmFzZU1hbmFnZXIpOwogICAgICBleHBlY3QocmVzKS50b0VxdWFsKAogICAgICAgIEpTT04ucGFyc2UoCiAgICAgICAgICBgeyJjZmciOiIxLjAuMCIsInRlbmFudElkIjogIkRFRkFVTFQiLCJpZCI6IjAyNEAxLjAuMCIsInJlYXNvbiI6IkltbWVkaWF0ZSBub24tY29tbWlzc2lvbmVkIHRyYW5zYWN0aW9uIG1pcnJvcmluZyBkZXRlY3RlZCIsInN1YlJ1bGVSZWYiOiIuMDEifWAsCiAgICAgICAgKSwKICAgICAgKTsKICAgIH0pOwoKICAgIHRlc3QoYC4wMiBzaG91bGQgcmV0dXJuIHJlYXNvbiBvZiAnQWdncmVnYXRlZCBub24tY29tbWlzc2lvbmVkIHRyYW5zYWN0aW9uIG1pcnJvcmluZyBkZXRlY3RlZCdgLCBhc3luYyAoKSA9PiB7CiAgICAgIGRhdGFiYXNlTWFuYWdlci5fZXZlbnRIaXN0b3J5LnF1ZXJ5Lm1vY2tSZXNvbHZlZFZhbHVlKHsKICAgICAgICByb3dzOiBbeyB0YXJnZXRBbW91bnQ6IDEwMDAsIGhpc3RvcmljYWxBbW91bnRzOiBbMTkwLCAxOTAsIDE5MCwgMTkwLCAxOTBdIH1dLAogICAgICB9KTsKICAgICAgY29uc3QgcmVzID0gYXdhaXQgaGFuZGxlVHJhbnNhY3Rpb24oZ2V0TW9ja1JlcXVlc3QoKSwgZGV0ZXJtaW5lT3V0Y29tZSwgcnVsZVJlc3VsdCwgbG9nZ2VyU2VydmljZSwgcnVsZUNvbmZpZywgZGF0YWJhc2VNYW5hZ2VyKTsKICAgICAgZXhwZWN0KHJlcykudG9FcXVhbCgKICAgICAgICBKU09OLnBhcnNlKAogICAgICAgICAgYHsiY2ZnIjoiMS4wLjAiLCJ0ZW5hbnRJZCI6ICJERUZBVUxUIiwiaWQiOiIwMjRAMS4wLjAiLCJyZWFzb24iOiJBZ2dyZWdhdGVkIG5vbi1jb21taXNzaW9uZWQgdHJhbnNhY3Rpb24gbWlycm9yaW5nIGRldGVjdGVkIiwic3ViUnVsZVJlZiI6Ii4wMiJ9YCwKICAgICAgICApLAogICAgICApOwogICAgfSk7CiAgfSk7CiAgZGVzY3JpYmUoJ0V4aXQgQ29uZGl0aW9ucyBUZXN0aW5nJywgKCkgPT4gewogICAgdGVzdCgnc2hvdWxkIHRocm93IGVycm9yIGlmIGNvbmZpZyBpc3N1ZXMgZm9yIHJ1bGUnLCBhc3luYyAoKSA9PiB7CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgaGFuZGxlVHJhbnNhY3Rpb24oCiAgICAgICAgICBnZXRNb2NrUmVxdWVzdCgpLAogICAgICAgICAgZGV0ZXJtaW5lT3V0Y29tZSwKICAgICAgICAgIHJ1bGVSZXN1bHQsCiAgICAgICAgICBsb2dnZXJTZXJ2aWNlLAogICAgICAgICAgewogICAgICAgICAgICAuLi5ydWxlQ29uZmlnLAogICAgICAgICAgICBjb25maWc6IHsgLi4ucnVsZUNvbmZpZy5jb25maWcsIGJhbmRzOiB1bmRlZmluZWQgfSwKICAgICAgICAgIH0sCiAgICAgICAgICBkYXRhYmFzZU1hbmFnZXIsCiAgICAgICAgKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBleHBlY3QoKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlKS50b0JlKCdJbnZhbGlkIGNvbmZpZyBwcm92aWRlZCAtIGJhbmRzIG5vdCBwcm92aWRlZCcpOwogICAgICB9CiAgICAgIGxldCBmYWlsQ29uZmlnOiBSdWxlQ29uZmlnID0gewogICAgICAgIC4uLnJ1bGVDb25maWcsCiAgICAgICAgY29uZmlnOiB7IC4uLnJ1bGVDb25maWcuY29uZmlnLCBiYW5kczogdW5kZWZpbmVkIH0sCiAgICAgIH07CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgaGFuZGxlVHJhbnNhY3Rpb24oCiAgICAgICAgICBnZXRNb2NrUmVxdWVzdCgpLAogICAgICAgICAgZGV0ZXJtaW5lT3V0Y29tZSwKICAgICAgICAgIHJ1bGVSZXN1bHQsCiAgICAgICAgICBsb2dnZXJTZXJ2aWNlLAogICAgICAgICAgewogICAgICAgICAgICAuLi5ydWxlQ29uZmlnLAogICAgICAgICAgICBjb25maWc6IHsgLi4ucnVsZUNvbmZpZy5jb25maWcsIGJhbmRzOiBbXSB9LAogICAgICAgICAgfSwKICAgICAgICAgIGRhdGFiYXNlTWFuYWdlciwKICAgICAgICApOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGV4cGVjdCgoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpLnRvQmUoJ0ludmFsaWQgY29uZmlnIHByb3ZpZGVkIC0gYmFuZHMgbm90IHByb3ZpZGVkJyk7CiAgICAgIH0KICAgICAgZmFpbENvbmZpZyA9IHsKICAgICAgICAuLi5ydWxlQ29uZmlnLAogICAgICAgIGNvbmZpZzogeyAuLi5ydWxlQ29uZmlnLmNvbmZpZywgZXhpdENvbmRpdGlvbnM6IHVuZGVmaW5lZCB9LAogICAgICB9OwogICAgICB0cnkgewogICAgICAgIGF3YWl0IGhhbmRsZVRyYW5zYWN0aW9uKGdldE1vY2tSZXF1ZXN0KCksIGRldGVybWluZU91dGNvbWUsIHJ1bGVSZXN1bHQsIGxvZ2dlclNlcnZpY2UsIGZhaWxDb25maWcsIGRhdGFiYXNlTWFuYWdlcik7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgZXhwZWN0KChlcnJvciBhcyBFcnJvcikubWVzc2FnZSkudG9CZSgnSW52YWxpZCBjb25maWcgcHJvdmlkZWQgLSBleGl0Q29uZGl0aW9ucyBub3QgcHJvdmlkZWQnKTsKICAgICAgfQogICAgfSk7CgogICAgdGVzdChgLngwMCBzaG91bGQgcmV0dXJuIHdpdGggcmVhc29uIG9mICdVbnN1Y2Nlc3NmdWwgdHJhbnNhY3Rpb24nIGlmIHRyYW5zYWN0aW9uIHNlbnQgaXMgbm90IHN1Y2Nlc3NmdWxgLCBhc3luYyAoKSA9PiB7CiAgICAgIC8vIE1vY2tpbmcgdGhlIHJlcXVlc3Qgb2YgZ2V0dGluZyBvbGRlcyB0cmFuc2F0aW9uIHRpbWVzdGFtcAogICAgICBjb25zdCByZXEgPSBnZXRNb2NrUmVxdWVzdCgpOwogICAgICByZXEudHJhbnNhY3Rpb24gPSBKU09OLnBhcnNlKAogICAgICAgIGB7IlR4VHAiOiJwYWNzLjAwMi4wMDEuMTIiLCJGSVRvRklQbXRTdHMiOnsiR3JwSGRyIjp7Ik1zZ0lkIjoiMzBiZWE3MWM1YTA1NDk3OGFkMGRhN2Y5NGIyYTQwZTk3ODkiLCJDcmVEdFRtIjoiJHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCl9In0sIlR4SW5mQW5kU3RzIjp7Ik9yZ25sSW5zdHJJZCI6IjVhYjRmYzczNTVkZTRlZjhhNzViNzhiMDBhNjgxZWQyMjU1IiwiT3JnbmxFbmRUb0VuZElkIjoiMmM1MTY4MDEwMDc2NDJkZmI4OTI5NDRkZGUxY2Y4NDU4OTciLCJUeFN0cyI6IkFDU0MiLCJDaHJnc0luZiI6W3siQW10Ijp7IkFtdCI6MzA3LjE0LCJDY3kiOiJVU0QifSwiQWd0Ijp7IkZpbkluc3RuSWQiOnsiQ2xyU3lzTW1iSWQiOnsiTW1iSWQiOiJkZnNwMDAxIn19fX0seyJBbXQiOnsiQW10IjoxNTMuNTcsIkNjeSI6IlVTRCJ9LCJBZ3QiOnsiRmluSW5zdG5JZCI6eyJDbHJTeXNNbWJJZCI6eyJNbWJJZCI6ImRmc3AwMDEifX19fSx7IkFtdCI6eyJBbXQiOjMwLjcxLCJDY3kiOiJVU0QifSwiQWd0Ijp7IkZpbkluc3RuSWQiOnsiQ2xyU3lzTW1iSWQiOnsiTW1iSWQiOiJkZnNwMDAyIn19fX1dLCJBY2NwdG5jRHRUbSI6IjIwMjEtMTItMDNUMTU6MjQ6MjYuMDAwWiIsIkluc3RnQWd0Ijp7IkZpbkluc3RuSWQiOnsiQ2xyU3lzTW1iSWQiOnsiTW1iSWQiOiJkZnNwMDAxIn19fSwiSW5zdGRBZ3QiOnsiRmluSW5zdG5JZCI6eyJDbHJTeXNNbWJJZCI6eyJNbWJJZCI6ImRmc3AwMDIifX19fX19YCwKICAgICAgKSBhcyBQYWNzMDAyOwogICAgICByZXEudHJhbnNhY3Rpb24uVGVuYW50SWQgPSAndGVuYW50LTAwMSc7CgogICAgICBkYXRhYmFzZU1hbmFnZXIuX2V2ZW50SGlzdG9yeS5xdWVyeS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IHJvd3M6IFt7IHRhcmdldEFtb3VudDogMzQzLCBoaXN0b3JpY2FsQW1vdW50czogWzIzLCA0NSwgMjNdIH1dIH0pOwoKICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCBoYW5kbGVUcmFuc2FjdGlvbigKICAgICAgICAgIHJlcSwKICAgICAgICAgIGRldGVybWluZU91dGNvbWUsCiAgICAgICAgICBydWxlUmVzdWx0LAogICAgICAgICAgbG9nZ2VyU2VydmljZSwKICAgICAgICAgIHsKICAgICAgICAgICAgLi4ucnVsZUNvbmZpZywKICAgICAgICAgICAgY29uZmlnOiB7CiAgICAgICAgICAgICAgLi4ucnVsZUNvbmZpZy5jb25maWcsCiAgICAgICAgICAgICAgZXhpdENvbmRpdGlvbnM6IFsKICAgICAgICAgICAgICAgIC8vIHsKICAgICAgICAgICAgICAgIC8vICAgc3ViUnVsZVJlZjogJy54MDAnLAogICAgICAgICAgICAgICAgLy8gICByZWFzb246ICdVbmNvbW1lbnRlZCByZXF1aXJlZCBleGl0IGNvbmRpdGlvbicsCiAgICAgICAgICAgICAgICAvLyB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBzdWJSdWxlUmVmOiAnLngwMScsCiAgICAgICAgICAgICAgICAgIHJlYXNvbjogJ0luc3VmZmljaWVudCB0cmFuc2FjdGlvbiBoaXN0b3J5JywKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICBkYXRhYmFzZU1hbmFnZXIsCiAgICAgICAgKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBleHBlY3QoKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlKS50b0JlKCdVbnN1Y2Nlc3NmdWwgdHJhbnNhY3Rpb24gYW5kIG5vIGV4aXQgY29uZGl0aW9uIGluIGNvbmZpZycpOwogICAgICB9CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgaGFuZGxlVHJhbnNhY3Rpb24ocmVxLCBkZXRlcm1pbmVPdXRjb21lLCBydWxlUmVzdWx0LCBsb2dnZXJTZXJ2aWNlLCBydWxlQ29uZmlnLCBkYXRhYmFzZU1hbmFnZXIpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGV4cGVjdCgoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpLnRvQmUoJ1Vuc3VjY2Vzc2Z1bCB0cmFuc2FjdGlvbicpOwogICAgICB9CiAgICB9KTsKCiAgICB0ZXN0KGAueDAxIHNob3VsZCByZXR1cm4gd2l0aCByZWFzb24gb2YgJ0luc3VmZmljaWVudCB0cmFuc2FjdGlvbiBoaXN0b3J5JyBpZiByZXR1cm4gbm8gaGlzdG9yaWNhbEFtb3VudHNgLCBhc3luYyAoKSA9PiB7CiAgICAgIGNvbnN0IHJlcSA9IGdldE1vY2tSZXF1ZXN0KCk7CiAgICAgIGRhdGFiYXNlTWFuYWdlci5fZXZlbnRIaXN0b3J5LnF1ZXJ5Lm1vY2tSZXNvbHZlZFZhbHVlKHsgcm93czogW3sgdGFyZ2V0QW1vdW50OiAzNDIsIGhpc3RvcmljYWxBbW91bnRzOiBbXSB9XSB9KTsKCiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgaGFuZGxlVHJhbnNhY3Rpb24ocmVxLCBkZXRlcm1pbmVPdXRjb21lLCBydWxlUmVzdWx0LCBsb2dnZXJTZXJ2aWNlLCBydWxlQ29uZmlnLCBkYXRhYmFzZU1hbmFnZXIpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGV4cGVjdCgoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpLnRvQmUoJ0luc3VmZmljaWVudCB0cmFuc2FjdGlvbiBoaXN0b3J5Jyk7CiAgICAgIH0KICAgICAgY29uc3QgcnVsZUNvbmZpZ3M6IFJ1bGVDb25maWcgPSB7CiAgICAgICAgaWQ6ICcwMDhAMS4wLjAnLAogICAgICAgIHRlbmFudElkOiAnREVGQVVMVCcsCiAgICAgICAgZGVzYzogJycsCiAgICAgICAgY2ZnOiAnMS4wLjAnLAogICAgICAgIGNvbmZpZzogewogICAgICAgICAgcGFyYW1ldGVyczogeyBtYXhRdWVyeVJhbmdlOiAyLCB0b2xlcmFuY2U6IDAuMSB9LAogICAgICAgICAgYmFuZHM6IHJ1bGVDb25maWcuY29uZmlnLmJhbmRzLAogICAgICAgICAgZXhpdENvbmRpdGlvbnM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHN1YlJ1bGVSZWY6ICcueDAwJywKICAgICAgICAgICAgICByZWFzb246ICdUZXN0IGV4aXQgY29uZGl0aW9uJywKICAgICAgICAgICAgfSwKICAgICAgICAgICAgLy8gewogICAgICAgICAgICAvLyAgIHN1YlJ1bGVSZWY6ICcueDAxJywKICAgICAgICAgICAgLy8gICByZWFzb246ICdVbmNvbW1lbnRlZCByZXF1aXJlZCAueDAxIGNvbmRpdGlvbicsCiAgICAgICAgICAgIC8vIH0sCiAgICAgICAgICBdLAogICAgICAgIH0sCiAgICAgIH07CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgaGFuZGxlVHJhbnNhY3Rpb24ocmVxLCBkZXRlcm1pbmVPdXRjb21lLCBydWxlUmVzdWx0LCBsb2dnZXJTZXJ2aWNlLCBydWxlQ29uZmlncywgZGF0YWJhc2VNYW5hZ2VyKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBleHBlY3QoKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlKS50b0JlKCdJbnN1ZmZpY2llbnQgSGlzdG9yeSBhbmQgbm8gZXhpdCBjb25kaXRpb24gaW4gY29uZmlnJyk7CiAgICAgIH0KICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCBoYW5kbGVUcmFuc2FjdGlvbigKICAgICAgICAgIHJlcSwKICAgICAgICAgIGRldGVybWluZU91dGNvbWUsCiAgICAgICAgICBydWxlUmVzdWx0LAogICAgICAgICAgbG9nZ2VyU2VydmljZSwKICAgICAgICAgIHsKICAgICAgICAgICAgLi4ucnVsZUNvbmZpZ3MsCiAgICAgICAgICAgIGNvbmZpZzogewogICAgICAgICAgICAgIC4uLnJ1bGVDb25maWdzLmNvbmZpZywKICAgICAgICAgICAgICBwYXJhbWV0ZXJzOiB7IG1heFF1ZXJ5UmFuZ2U6IDMyNCwgdG9sZXJhbmNlOiAwLjEgfSwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICBkYXRhYmFzZU1hbmFnZXIsCiAgICAgICAgKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBleHBlY3QoKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlKS50b0JlKCdJbnN1ZmZpY2llbnQgSGlzdG9yeSBhbmQgbm8gZXhpdCBjb25kaXRpb24gaW4gY29uZmlnJyk7CiAgICAgIH0KICAgIH0pOwoKICAgIHRlc3QoYC54MDMgc2hvdWxkIHJldHVybiByZWFzb24gb2YgJ05vIG5vbi1jb21taXNzaW9uZWQgdHJhbnNhY3Rpb24gbWlycm9yaW5nIGRldGVjdGVkJyB0aGUgaGlzdG9yaWNhbCBkaWRuJ3QgbWVldCB0aGUgdGFyZ2V0IGFtb3VudGAsIGFzeW5jICgpID0+IHsKICAgICAgZGF0YWJhc2VNYW5hZ2VyLl9ldmVudEhpc3RvcnkucXVlcnkubW9ja1Jlc29sdmVkVmFsdWUoewogICAgICAgIHJvd3M6IFt7IHRhcmdldEFtb3VudDogMTAwMDAsIGhpc3RvcmljYWxBbW91bnRzOiBbMTkwLCAxOTAsIDE5MCwgMTkwLCAxOTBdIH1dLAogICAgICB9KTsKCiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGhhbmRsZVRyYW5zYWN0aW9uKGdldE1vY2tSZXF1ZXN0KCksIGRldGVybWluZU91dGNvbWUsIHJ1bGVSZXN1bHQsIGxvZ2dlclNlcnZpY2UsIHJ1bGVDb25maWcsIGRhdGFiYXNlTWFuYWdlcik7CiAgICAgIGV4cGVjdChyZXMpLnRvRXF1YWwoCiAgICAgICAgSlNPTi5wYXJzZSgKICAgICAgICAgIGB7ImNmZyI6IjEuMC4wIiwidGVuYW50SWQiOiAiREVGQVVMVCIsImlkIjoiMDI0QDEuMC4wIiwicmVhc29uIjoiTm8gbm9uLWNvbW1pc3Npb25lZCB0cmFuc2FjdGlvbiBtaXJyb3JpbmcgZGV0ZWN0ZWQiLCJzdWJSdWxlUmVmIjoiLngwMyJ9YCwKICAgICAgICApLAogICAgICApOwogICAgICBjb25zdCBmYWlsRXhpdENvbmRpdGlvbiA9IFsKICAgICAgICB7CiAgICAgICAgICBzdWJSdWxlUmVmOiAnLngwMCcsCiAgICAgICAgICByZWFzb246ICdVbnN1Y2Nlc3NmdWwgdHJhbnNhY3Rpb24nLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgc3ViUnVsZVJlZjogJy54MDEnLAogICAgICAgICAgcmVhc29uOiAnSW5zdWZmaWNpZW50IHRyYW5zYWN0aW9uIGhpc3RvcnknLAogICAgICAgIH0sCiAgICAgIF07CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmVxMiA9IGdldE1vY2tSZXF1ZXN0KCk7CiAgICAgICAgcmVxMi50cmFuc2FjdGlvbi5UZW5hbnRJZCA9ICd0ZW5hbnQtMDAxJzsKICAgICAgICBhd2FpdCBoYW5kbGVUcmFuc2FjdGlvbigKICAgICAgICAgIHJlcTIsCiAgICAgICAgICBkZXRlcm1pbmVPdXRjb21lLAogICAgICAgICAgcnVsZVJlc3VsdCwKICAgICAgICAgIGxvZ2dlclNlcnZpY2UsCiAgICAgICAgICB7CiAgICAgICAgICAgIC4uLnJ1bGVDb25maWcsCiAgICAgICAgICAgIGNvbmZpZzogewogICAgICAgICAgICAgIC4uLnJ1bGVDb25maWcuY29uZmlnLAogICAgICAgICAgICAgIGV4aXRDb25kaXRpb25zOiBmYWlsRXhpdENvbmRpdGlvbiwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICBkYXRhYmFzZU1hbmFnZXIsCiAgICAgICAgKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBleHBlY3QoKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlKS50b0JlKCdObyBub24tY29tbWlzc2lvbmVkIHRyYW5zYWN0aW9uIG1pcnJvcmluZyBkZXRlY3RlZCBhbmQgbm8gZXhpdCBjb25kaXRpb24gaW4gY29uZmlnJyk7CiAgICAgIH0KICAgIH0pOwoKICAgIHRlc3QoYGVycm9yIHdhcyB0aHJvd24gZHVyaW5nIHRoZSBleGVjdXRpb24gb2YgU1FMIHN0YXRlbWVudCBEQiBtYW5hZ2VyIGNvbXBsYWluc2AsIGFzeW5jICgpID0+IHsKICAgICAgZGF0YWJhc2VNYW5hZ2VyLl9ldmVudEhpc3RvcnkucXVlcnkubW9ja1JlamVjdGVkVmFsdWVPbmNlKG5ldyBFcnJvcignQXN5bmMgZXJyb3InKSk7CgogICAgICBjb25zdCByZXEgPSBnZXRNb2NrUmVxdWVzdCgpOwogICAgICByZXEudHJhbnNhY3Rpb24uVGVuYW50SWQgPSAndGVuYW50LTAwMSc7CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgaGFuZGxlVHJhbnNhY3Rpb24oZ2V0TW9ja1JlcXVlc3QoKSwgZGV0ZXJtaW5lT3V0Y29tZSwgcnVsZVJlc3VsdCwgbG9nZ2VyU2VydmljZSwgcnVsZUNvbmZpZywgZGF0YWJhc2VNYW5hZ2VyKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBleHBlY3QoKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlKS50b0JlRGVmaW5lZCgpOwogICAgICB9CiAgICB9KTsKCiAgICB0ZXN0KGBlcnJvciB3YXMgdGhyb3duIHdoZW4gZGF0YWNhY2hlIG9iamVjdCB3YXMgbWlzc2luZyB0aGUgcmVxdWlyZWQgYXR0cmlidXRlIC0gY2R0ckFjY3RJZGAsIGFzeW5jICgpID0+IHsKICAgICAgY29uc3QgZGF0YUNhY2hlOiBEYXRhQ2FjaGUgPSB7CiAgICAgICAgZGJ0cklkOiAnZW50aXRpZXMvZGJ0cl83ZGRhNGRmYzdhMmU0OGVjYmVhOWQ0MDNiNzkzZjQ4NScsCiAgICAgICAgY2R0cklkOiAnZW50aXRpZXMvY2R0cl8zOGU2MTQxMTE5ZjM0ZTVmYTU0OTI4NjQ1NWU3ZWZkNycsCiAgICAgICAgLy8gY2R0ckFjY3RJZDogJ2NkdHJBY2N0XzhiYjY1NTBiYWM4NDQ4ZDQ4MjVjYjZmMzllNzE3NGNjJywKICAgICAgICBjcmVEdFRtOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksCiAgICAgIH07CiAgICAgIGRhdGFiYXNlTWFuYWdlci5fZXZlbnRIaXN0b3J5LnF1ZXJ5Lm1vY2tSZXNvbHZlZFZhbHVlKHsgcm93czogW3sgdGFyZ2V0QW1vdW50OiAxMDAwMiwgaGlzdG9yaWNhbEFtb3VudHM6IFt7fV0gfV0gfSk7CgogICAgICBjb25zdCByZXEgPSBnZXRNb2NrUmVxdWVzdCgpOwogICAgICByZXEudHJhbnNhY3Rpb24uVGVuYW50SWQgPSAndGVuYW50LTAwMSc7CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgaGFuZGxlVHJhbnNhY3Rpb24oCiAgICAgICAgICB7IC4uLmdldE1vY2tSZXF1ZXN0KCksIERhdGFDYWNoZTogZGF0YUNhY2hlIH0sCiAgICAgICAgICBkZXRlcm1pbmVPdXRjb21lLAogICAgICAgICAgcnVsZVJlc3VsdCwKICAgICAgICAgIGxvZ2dlclNlcnZpY2UsCiAgICAgICAgICBydWxlQ29uZmlnLAogICAgICAgICAgZGF0YWJhc2VNYW5hZ2VyLAogICAgICAgICk7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVTlJFQUNIQUJMRScpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGV4cGVjdCgoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpLnRvQmUoJ0RhdGFDYWNoZSBvYmplY3Qgbm90IHJldHJpZXZhYmxlJyk7CiAgICAgIH0KICAgIH0pOwoKICAgIHRlc3QoYGVycm9yIHdhcyB0aHJvd24gd2hlbiBkYXRhY2FjaGUgb2JqZWN0IHdhcyBtaXNzaW5nIHRoZSByZXF1aXJlZCBhdHRyaWJ1dGUgLSBjcmVEdFRtYCwgYXN5bmMgKCkgPT4gewogICAgICBjb25zdCBkYXRhQ2FjaGU6IERhdGFDYWNoZSA9IHsKICAgICAgICBkYnRySWQ6ICdlbnRpdGllcy9kYnRyXzdkZGE0ZGZjN2EyZTQ4ZWNiZWE5ZDQwM2I3OTNmNDg1JywKICAgICAgICBjZHRySWQ6ICdlbnRpdGllcy9jZHRyXzM4ZTYxNDExMTlmMzRlNWZhNTQ5Mjg2NDU1ZTdlZmQ3JywKICAgICAgICBjZHRyQWNjdElkOiAnY2R0ckFjY3RfOGJiNjU1MGJhYzg0NDhkNDgyNWNiNmYzOWU3MTc0Y2MnLAogICAgICAgIC8vIGNyZUR0VG06IERhdGUubm93KCkudG9TdHJpbmcoKSwKICAgICAgfTsKICAgICAgZGF0YWJhc2VNYW5hZ2VyLl9ldmVudEhpc3RvcnkucXVlcnkubW9ja1Jlc29sdmVkVmFsdWUoeyByb3dzOiBbeyB0YXJnZXRBbW91bnQ6IDEwMDAyLCBoaXN0b3JpY2FsQW1vdW50czogW3t9XSB9XSB9KTsKCiAgICAgIGNvbnN0IHJlcSA9IGdldE1vY2tSZXF1ZXN0KCk7CiAgICAgIHJlcS50cmFuc2FjdGlvbi5UZW5hbnRJZCA9ICd0ZW5hbnQtMDAxJzsKICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCBoYW5kbGVUcmFuc2FjdGlvbigKICAgICAgICAgIHsgLi4uZ2V0TW9ja1JlcXVlc3QoKSwgRGF0YUNhY2hlOiBkYXRhQ2FjaGUgfSwKICAgICAgICAgIGRldGVybWluZU91dGNvbWUsCiAgICAgICAgICBydWxlUmVzdWx0LAogICAgICAgICAgbG9nZ2VyU2VydmljZSwKICAgICAgICAgIHJ1bGVDb25maWcsCiAgICAgICAgICBkYXRhYmFzZU1hbmFnZXIsCiAgICAgICAgKTsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VOUkVBQ0hBQkxFJyk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgZXhwZWN0KChlcnJvciBhcyBFcnJvcikubWVzc2FnZSkudG9CZSgnRGF0YUNhY2hlIGRvZXMgbm90IGhhdmUgQ3JlRHRUbScpOwogICAgICB9CiAgICB9KTsKCiAgICB0ZXN0KGBlcnJvciB3YXMgdGhyb3duIHdoZW4gZXhpdENvbmRpdGlvbnMgd2VyZSBub3QgZm91bmRgLCBhc3luYyAoKSA9PiB7CiAgICAgIGRhdGFiYXNlTWFuYWdlci5fZXZlbnRIaXN0b3J5LnF1ZXJ5Lm1vY2tSZXNvbHZlZFZhbHVlKHsgcm93czogW3sgdGFyZ2V0QW1vdW50OiAxMDAwMiwgaGlzdG9yaWNhbEFtb3VudHM6IFt7fV0gfV0gfSk7CgogICAgICBjb25zdCByZXEgPSBnZXRNb2NrUmVxdWVzdCgpOwogICAgICByZXEudHJhbnNhY3Rpb24uVGVuYW50SWQgPSAndGVuYW50LTAwMSc7CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgaGFuZGxlVHJhbnNhY3Rpb24oCiAgICAgICAgICByZXEsCiAgICAgICAgICBkZXRlcm1pbmVPdXRjb21lLAogICAgICAgICAgcnVsZVJlc3VsdCwKICAgICAgICAgIGxvZ2dlclNlcnZpY2UsCiAgICAgICAgICB7CiAgICAgICAgICAgIC4uLnJ1bGVDb25maWcsCiAgICAgICAgICAgIGNvbmZpZzogeyAuLi5ydWxlQ29uZmlnLmNvbmZpZywgZXhpdENvbmRpdGlvbnM6IHVuZGVmaW5lZCB9LAogICAgICAgICAgfSwKICAgICAgICAgIGRhdGFiYXNlTWFuYWdlciwKICAgICAgICApOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGV4cGVjdCgoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpLnRvQmUoJ0ludmFsaWQgY29uZmlnIHByb3ZpZGVkIC0gZXhpdENvbmRpdGlvbnMgbm90IHByb3ZpZGVkJyk7CiAgICAgIH0KICAgIH0pOwoKICAgIHRlc3QoYGVycm9yIHdhcyB0aHJvd24gd2hlbiBwYXJhbWV0ZXJzIHdlcmUgbm90IGZvdW5kYCwgYXN5bmMgKCkgPT4gewogICAgICBkYXRhYmFzZU1hbmFnZXIuX2V2ZW50SGlzdG9yeS5xdWVyeS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IHJvd3M6IFt7IHRhcmdldEFtb3VudDogMTAwMDIsIGhpc3RvcmljYWxBbW91bnRzOiBbe31dIH1dIH0pOwoKICAgICAgY29uc3QgcmVxID0gZ2V0TW9ja1JlcXVlc3QoKTsKICAgICAgcmVxLnRyYW5zYWN0aW9uLlRlbmFudElkID0gJ3RlbmFudC0wMDEnOwogICAgICB0cnkgewogICAgICAgIGF3YWl0IGhhbmRsZVRyYW5zYWN0aW9uKAogICAgICAgICAgcmVxLAogICAgICAgICAgZGV0ZXJtaW5lT3V0Y29tZSwKICAgICAgICAgIHJ1bGVSZXN1bHQsCiAgICAgICAgICBsb2dnZXJTZXJ2aWNlLAogICAgICAgICAgewogICAgICAgICAgICAuLi5ydWxlQ29uZmlnLAogICAgICAgICAgICBjb25maWc6IHsgLi4ucnVsZUNvbmZpZy5jb25maWcsIHBhcmFtZXRlcnM6IHVuZGVmaW5lZCB9LAogICAgICAgICAgfSwKICAgICAgICAgIGRhdGFiYXNlTWFuYWdlciwKICAgICAgICApOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGV4cGVjdCgoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpLnRvQmUoJ0ludmFsaWQgY29uZmlnIHByb3ZpZGVkIC0gcGFyYW1ldGVycyBub3QgcHJvdmlkZWQnKTsKICAgICAgfQogICAgfSk7CgogICAgdGVzdChgZXJyb3Igd2FzIHRocm93biB3aGVuIHRvbGVyYW5jZSB3ZXJlIG5vdCBmb3VuZGAsIGFzeW5jICgpID0+IHsKICAgICAgZGF0YWJhc2VNYW5hZ2VyLl9ldmVudEhpc3RvcnkucXVlcnkubW9ja1Jlc29sdmVkVmFsdWUoeyByb3dzOiBbeyB0YXJnZXRBbW91bnQ6IDEwMDAyLCBoaXN0b3JpY2FsQW1vdW50czogW3t9XSB9XSB9KTsKCiAgICAgIGNvbnN0IHJlcSA9IGdldE1vY2tSZXF1ZXN0KCk7CiAgICAgIHJlcS50cmFuc2FjdGlvbi5UZW5hbnRJZCA9ICd0ZW5hbnQtMDAxJzsKICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCBoYW5kbGVUcmFuc2FjdGlvbigKICAgICAgICAgIHJlcSwKICAgICAgICAgIGRldGVybWluZU91dGNvbWUsCiAgICAgICAgICBydWxlUmVzdWx0LAogICAgICAgICAgbG9nZ2VyU2VydmljZSwKICAgICAgICAgIHsKICAgICAgICAgICAgLi4ucnVsZUNvbmZpZywKICAgICAgICAgICAgY29uZmlnOiB7CiAgICAgICAgICAgICAgLi4ucnVsZUNvbmZpZy5jb25maWcsCiAgICAgICAgICAgICAgcGFyYW1ldGVyczogeyB0b2xlcmFuY2U6IHVuZGVmaW5lZCB9LAogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICAgIGRhdGFiYXNlTWFuYWdlciwKICAgICAgICApOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGV4cGVjdCgoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpLnRvQmUoJ0ludmFsaWQgY29uZmlnIHByb3ZpZGVkIC0gdG9sZXJhbmNlIHBhcmFtZXRlciBub3QgcHJvdmlkZWQgb3IgaW52YWxpZCB0eXBlJyk7CiAgICAgIH0KICAgIH0pOwoKICAgIHRlc3QoYGVycm9yIHdhcyB0aHJvd24gd2hlbiBtYXhRdWVyeVJhbmdlICB3ZXJlIG5vdCBmb3VuZGAsIGFzeW5jICgpID0+IHsKICAgICAgZGF0YWJhc2VNYW5hZ2VyLl9ldmVudEhpc3RvcnkucXVlcnkubW9ja1Jlc29sdmVkVmFsdWUoeyByb3dzOiBbeyB0YXJnZXRBbW91bnQ6IDEwMDAyLCBoaXN0b3JpY2FsQW1vdW50czogW3t9XSB9XSB9KTsKCiAgICAgIGNvbnN0IHJlcSA9IGdldE1vY2tSZXF1ZXN0KCk7CiAgICAgIHJlcS50cmFuc2FjdGlvbi5UZW5hbnRJZCA9ICd0ZW5hbnQtMDAxJzsKICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCBoYW5kbGVUcmFuc2FjdGlvbigKICAgICAgICAgIHJlcSwKICAgICAgICAgIGRldGVybWluZU91dGNvbWUsCiAgICAgICAgICBydWxlUmVzdWx0LAogICAgICAgICAgbG9nZ2VyU2VydmljZSwKICAgICAgICAgIHsKICAgICAgICAgICAgLi4ucnVsZUNvbmZpZywKICAgICAgICAgICAgY29uZmlnOiB7CiAgICAgICAgICAgICAgLi4ucnVsZUNvbmZpZy5jb25maWcsCiAgICAgICAgICAgICAgcGFyYW1ldGVyczogeyBtYXhRdWVyeVJhbmdlOiB1bmRlZmluZWQsIHRvbGVyYW5jZTogMC4yIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgICAgZGF0YWJhc2VNYW5hZ2VyLAogICAgICAgICk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgZXhwZWN0KChlcnJvciBhcyBFcnJvcikubWVzc2FnZSkudG9CZSgnSW52YWxpZCBjb25maWcgcHJvdmlkZWQgLSBtYXhRdWVyeVJhbmdlIHBhcmFtZXRlciBub3QgcHJvdmlkZWQgb3IgaW52YWxpZCB0eXBlJyk7CiAgICAgIH0KICAgIH0pOwoKICAgIHRlc3QoYGVycm9yIHdhcyB0aHJvd24gaGlzdG9yaWNhbCBhbW91bnQgYXJyYXksIGhhdmUgZ290IHVuZXhwZWN0ZWQgdmFsdWVgLCBhc3luYyAoKSA9PiB7CiAgICAgIGRhdGFiYXNlTWFuYWdlci5fZXZlbnRIaXN0b3J5LnF1ZXJ5Lm1vY2tSZXNvbHZlZFZhbHVlKHsKICAgICAgICByb3dzOiBbeyB0YXJnZXRBbW91bnQ6IDEwMDAsIGhpc3RvcmljYWxBbW91bnRzOiBbMTkwLCAnc3RyaW5nIGZvciBzb21lIHJlYXNvbicsIDE5MCwgMTkwLCAxOTBdIH1dLAogICAgICB9KTsKCiAgICAgIGNvbnN0IHJlcSA9IGdldE1vY2tSZXF1ZXN0KCk7CiAgICAgIHJlcS50cmFuc2FjdGlvbi5UZW5hbnRJZCA9ICd0ZW5hbnQtMDAxJzsKICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCBoYW5kbGVUcmFuc2FjdGlvbihnZXRNb2NrUmVxdWVzdCgpLCBkZXRlcm1pbmVPdXRjb21lLCBydWxlUmVzdWx0LCBsb2dnZXJTZXJ2aWNlLCBydWxlQ29uZmlnLCBkYXRhYmFzZU1hbmFnZXIpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGV4cGVjdCgoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpLnRvQmUoJ0RhdGEgZXJyb3I6IHF1ZXJ5IHJlc3VsdCB0eXBlIG1pc21hdGNoIC0gZXhwZWN0ZWQgW251bWJlcnNdJyk7CiAgICAgIH0KICAgIH0pOwoKICAgIHRlc3QoYGVycm9yIHdhcyB0aHJvd24gd2hlbiB0YXJnZXQgYW1vdW50IHdhcyBub3QgZm91bmRgLCBhc3luYyAoKSA9PiB7CiAgICAgIGRhdGFiYXNlTWFuYWdlci5fZXZlbnRIaXN0b3J5LnF1ZXJ5Lm1vY2tSZXNvbHZlZFZhbHVlKHsgcm93czogW3sgdGFyZ2V0QW1vdW50OiB1bmRlZmluZWQsIGhpc3RvcmljYWxBbW91bnRzOiBbMzQsIDIxLCAzNDVdIH1dIH0pOwoKICAgICAgY29uc3QgcmVxID0gZ2V0TW9ja1JlcXVlc3QoKTsKICAgICAgcmVxLnRyYW5zYWN0aW9uLlRlbmFudElkID0gJ3RlbmFudC0wMDEnOwogICAgICB0cnkgewogICAgICAgIGF3YWl0IGhhbmRsZVRyYW5zYWN0aW9uKGdldE1vY2tSZXF1ZXN0KCksIGRldGVybWluZU91dGNvbWUsIHJ1bGVSZXN1bHQsIGxvZ2dlclNlcnZpY2UsIHJ1bGVDb25maWcsIGRhdGFiYXNlTWFuYWdlcik7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgZXhwZWN0KChlcnJvciBhcyBFcnJvcikubWVzc2FnZSkudG9CZSgnRGF0YSBlcnJvcjogaXJyZXRyaWV2YWJsZSB0cmFuc2FjdGlvbiBoaXN0b3J5Jyk7CiAgICAgIH0KICAgIH0pOwoKICAgIHRlc3QoYGVycm9yIHdhcyB0aHJvd24gd2hlbiB0aGUgY2FsbCB0byBEQiBNYW5hZ2VyIHJldHVybmVkIG5vIHJvd3NgLCBhc3luYyAoKSA9PiB7CiAgICAgIC8vIE1vY2tpbmcgdGhlIHJlcXVlc3Qgb2YgZ2V0dGluZyBvbGRlcyB0cmFuc2F0aW9uIHRpbWVzdGFtcAogICAgICBkYXRhYmFzZU1hbmFnZXIuX2V2ZW50SGlzdG9yeS5xdWVyeS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IHJvd3M6IFtdIH0pOwoKICAgICAgY29uc3QgcmVxID0gZ2V0TW9ja1JlcXVlc3QoKTsKICAgICAgcmVxLnRyYW5zYWN0aW9uLlRlbmFudElkID0gJ3RlbmFudC0wMDEnOwogICAgICB0cnkgewogICAgICAgIGF3YWl0IGhhbmRsZVRyYW5zYWN0aW9uKGdldE1vY2tSZXF1ZXN0KCksIGRldGVybWluZU91dGNvbWUsIHJ1bGVSZXN1bHQsIGxvZ2dlclNlcnZpY2UsIHJ1bGVDb25maWcsIGRhdGFiYXNlTWFuYWdlcik7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgZXhwZWN0KChlcnJvciBhcyBFcnJvcikubWVzc2FnZSkudG9CZSgnRGF0YSBlcnJvcjogaXJyZXRyaWV2YWJsZSB0cmFuc2FjdGlvbiBoaXN0b3J5Jyk7CiAgICAgIH0KICAgIH0pOwogIH0pOwogIGRlc2NyaWJlKCdSdWxlLTAyNCBIZWxwZXJzJywgKCkgPT4gewogICAgdGVzdCgnQW1vdW50IFRyYWNraW5nIGZ1bmN0aW9uJywgKCkgPT4gewogICAgICBsZXQgaW50ZXJhdGlvblZhbHVlID0gYW1vdW50VHJhY2tpbmcoMC4xLCAxMDAwLCBbMTkwLCAxOTAsIDE5MCwgMTkwLCAxOTBdKTsKICAgICAgZXhwZWN0KGludGVyYXRpb25WYWx1ZSkudG9FcXVhbCg1KTsKICAgIH0pOwogIH0pOwp9KTs=\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/v1/populate",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "api",
            "v1",
            "populate"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Promote Rule Repository",
      "request": {
        "auth": {
          "type": "bearer",
          "bearer": [
            {
              "key": "token",
              "value": "{{ACCESS_TOKEN}}",
              "type": "string"
            }
          ]
        },
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\r\n    \"organization\": \"psl-copilot\",\r\n    \"ruleId\": \"148\",\r\n    \"branchName\": \"dev\"\r\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{baseUrl}}/api/v1/promote",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "api",
            "v1",
            "promote"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Report Rule Repository",
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "auth": {
          "type": "bearer",
          "bearer": [
            {
              "key": "token",
              "value": "{{ACCESS_TOKEN}}",
              "type": "string"
            }
          ]
        },
        "method": "GET",
        "header": [],
        "body": {
          "mode": "raw",
          "raw": "",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{baseUrl}}/api/v1/report?organization={{organization}}&ruleId={{ruleId}}&branchName={{branchName}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "api",
            "v1",
            "report"
          ],
          "query": [
            {
              "key": "organization",
              "value": "{{organization}}"
            },
            {
              "key": "ruleId",
              "value": "{{ruleId}}"
            },
            {
              "key": "branchName",
              "value": "{{branchName}}"
            }
          ]
        }
      },
      "response": []
    },
    {
      "name": "WorkFlow Status Rule Repository",
      "request": {
        "auth": {
          "type": "bearer",
          "bearer": [
            {
              "key": "token",
              "value": "{{ACCESS_TOKEN}}",
              "type": "string"
            }
          ]
        },
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/api/v1/unit-tests/status?organization={{organization}}&ruleId={{ruleId}}&branchName={{branchName}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "api",
            "v1",
            "unit-tests",
            "status"
          ],
          "query": [
            {
              "key": "organization",
              "value": "{{organization}}"
            },
            {
              "key": "ruleId",
              "value": "{{ruleId}}"
            },
            {
              "key": "branchName",
              "value": "{{branchName}}"
            }
          ]
        }
      },
      "response": []
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000"
    }
  ]
}